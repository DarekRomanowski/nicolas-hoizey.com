---
layout: default
title: Pas de connexion
---

<div class="error offline clearfix">
  <p class="icon">{% asset icon-offline.svg %}</p>
  <p class="info">Désolé, <strong>vous ne semblez pas être connecté</strong>, et la page à laquelle vous essayez d'accéder n'est pas dans votre cache.</p>
</div>
<p>En attendant de retrouver une connexion, vous pouvez en apprendre plus <a href="/a-propos/de-moi.html">à propos de moi</a> ou <a href="/a-propos/du-site.html">de ce site</a>, ou lire mon dernier billet ou une des autres pages disponibles dans votre cache :</p>
{% for post in site.posts limit:1 %}
<script>
var lastPostUrl = '{{ post.url }}';
</script>
  <article class="latest">
    <h2><a href="{{ post.url }}">{{ post.title }}</a></h2>
    {% include article-header.html page=post %}
    {{ post.excerpt | strip_footnotes }}
  </article>
{% endfor %}
<ul id="cache-entries"></ul>

<script>
// https://googlechrome.github.io/samples/service-worker/window-caches/
var cacheEntriesUl = document.querySelector('#cache-entries');

window.caches.keys().then(cacheNames => {
  cacheNames.forEach(cacheName => {
    if (/\:\:pages/.test(cacheName)) {
      window.caches.open(cacheName).then(cache => {
        return cache.keys();
      })
      .then(requests => {
        requests.forEach(request => {
          if (request.url !== lastPostUrl
              && !/\/offline\.html$/.test(request.url)
              && !/\/a-propos\/(de-moi|du-site)\.html$/.test(request.url)
          ) {
            addRequestToList(cacheName, request);
          }
        });
      });
    }
  });
});

function addRequestToList(cacheName, request) {
  var url = request.url;
  var shortUrl = url.replace(/https:\/\/nicolas-hoizey\.com/, '').replace(/http:\/\/127\.0\.0\.1:4000/, '');

  // if (shortUrl !== lastPostUrl) {
    var linkElement = document.createElement('a');
    linkElement.href = url;
    linkElement.textContent = shortUrl;

    var liElement = document.createElement('li');
    liElement.appendChild(linkElement);

    cacheEntriesUl.appendChild(liElement);
  // }
}
</script>
